% TEMPLATE for Usenix papers, specifically to meet requirements of
%  USENIX '05
% originally a template for producing IEEE-format articles using LaTeX.
%   written by Matthew Ward, CS Department, Worcester Polytechnic Institute.
% adapted by David Beazley for his excellent SWIG paper in Proceedings,
%   Tcl 96
% turned into a smartass generic template by De Clarke, with thanks to
%   both the above pioneers
% use at your own risk.  Complaints to /dev/null.
% make it two column with no page numbering, default is 10 point

% Munged by Fred Douglis <douglis@research.att.com> 10/97 to separate
% the .sty file from the LaTeX source template, so that people can
% more easily include the .sty file into an existing document.  Also
% changed to more closely follow the style guidelines as represented
% by the Word sample file. 

% Note that since 2010, USENIX does not require endnotes. If you want
% foot of page notes, don't include the endnotes package in the 
% usepackage command, below.

% This version uses the latex2e styles, not the very ancient 2.09 stuff.
\documentclass[letterpaper,twocolumn,10pt]{article}
\usepackage{usenix,epsfig,endnotes}
\begin{document}

%don't want date printed
\date{}

%make title bold and 14 pt font (Latex default is non-bold, 16 pt)
\title{\Large \bf Simhash-based Website Model for Cloaking Detection}

%for single author (just remove % characters)
\author{
{\rm Your N.\ Here}\\
Your Institution
\and
{\rm Second Name}\\
Second Institution
% copy the following lines to add more authors
% \and
% {\rm Name}\\
%Name Institution
} % end author

\maketitle

% Use the following at camera-ready time to suppress page numbers.
% Comment it out when you first submit the paper for review.
\thispagestyle{empty}


\subsection*{Abstract}
Cloaking, used by spammers for the purpose of increasing the visiting rates of
their website, as well as to circumvent censorship, has been a challenging
spamming technique to search engines. Recently, there is a rising trend of employing cloaking in advertisement spam ~\cite{li2012knowing}.  The motivation of cloaking is to hide the true nature of a website by delivering different semantic content users versus censors.
Cloaking is popular due to low cost to setup and lack of efficient technique to detect.

There are two major challenges in cloaking detection:(A) revealing the uncloaked content (B) differentiating cloaking from naturally dynamic changes of the same page. This work employs simhash-based ~\cite{charikar2002similarity} website modeling to detect cloaking. The key idea to address challenge (A) is to crowd-source data collection to user. However, collect such information directly violates user privacy. Simhash-based website model helps protect user privacy and address challenge (B).

In order to show the effectiveness of simhash-based website model, we build a two phase system. Results have shown data set show that we can achieve more than 95\% True positive rate with 5\% false positive rate.


\section{Introduction}

Cloaking, used by spammers for the purpose of increasing the visiting rates of
their website, as well as to circumvent censorship, has been a challenging
spamming technique to search engines. Recently, there is a rising trend of employing cloaking in advertisement spam \cite{li2012knowing}.  The motivation of cloaking is to hide the true nature of a website by delivering different semantic content users versus censors.

Spammers use user agent, referer, IP etc based cloaking techniques to differentiate censors and normal users.

Cloaking is popular due to the low cost to setup and lack of efficient technique to detect. Spammers use user agent, referer, IP etc based cloaking techniques to differentiate censors and normal users.

There are two major challenges in cloaking detection (A) revealing the uncloaked content (B) differentiating cloaking from naturally dynamic changes of the same page. Existing approaches pretend to be the user, e.g. use proxies, set referer, to reveal the uncloaked content, but spammers could detect and block them. An intuitive way is to collect data from user directly. However, it is hard to collect sufficient data for comparison while protecting user privacy.


The workflow is to collect page contents simhash on the user side, and compare them to simhash of the same link from ad serving company to find cloaking. When the differences of the simhashes are significantly large, the page is marked cloaking. We generate two simhash for page content and structure respectively. Intuition behind this is, simhash difference between different sites are larger than different visits of the same site. We build a two-phase system to detect cloaking: cluster learning phase, and cloaking detection phase. In the cluster learning phase, an ad company visit urls and generate simhash from its content with its owned IP, and learn pattern and distribution of the simhashes, i.e. simhash-based website model. In the cloaking detection phase, the ad company collects simhash from its users. Compare them with learned patterns, return cloaking score or mismatch. Results on have shown data set show that we can achieve more than 95\% True positive rate with 5\% false positive rate for page content simhash and 100\% true positive rate with 2\% false positive rate for structure simhash. If we define cloaking as mismatch in both page content simhash and structure simhash (intersection of mismatches in both case), we can achieve more than 99\% true positive rate with 1\% false positive rate.


A paragraph of text goes here.  Lots of text.  Plenty of interesting
text. \\

More fascinating text. Features\endnote{Remember to use endnotes, not footnotes!} galore, plethora of promises.\\

\input{Related Work}
\section{Related Work}
Talk about simhash related work here.

Talk about cloaking detection related work here.


Some embedded literal typeset code might 
look like the following :

{\tt \small
\begin{verbatim}
int wrap_fact(ClientData clientData,
              Tcl_Interp *interp,
              int argc, char *argv[]) {
    int result;
    int arg0;
    if (argc != 2) {
        interp->result = "wrong # args";
        return TCL_ERROR;
    }
    arg0 = atoi(argv[1]);
    result = fact(arg0);
    sprintf(interp->result,"%d",result);
    return TCL_OK;
}
\end{verbatim}
}

Now we're going to cite somebody.  Watch for the cite tag.
Here it comes~\cite{Chaum1981,Diffie1976}.  The tilde character (\~{})
in the source means a non-breaking space.  This way, your reference will
always be attached to the word that preceded it, instead of going to the
next line.

\section{Simhash-based Web Model}
\subsection{Computation}

Here's a typical figure reference.  The figure is centered at the
top of the column.  It's scaled.  It's explicitly placed.  You'll
have to tweak the numbers to get what you want.\\

% you can also use the wonderful epsfig package...
\begin{figure}[t]
\begin{center}
\begin{picture}(300,150)(0,200)
\put(-15,-30){\special{psfile = fig1.ps hscale = 50 vscale = 50}}
\end{picture}\\
\end{center}
\caption{Wonderful Flowchart}
\end{figure}

This text came after the figure, so we'll casually refer to Figure 1
as we go on our merry way.

\subsection{Aggregating / Clustering}

It can get tricky typesetting Tcl and C code in LaTeX because they share
a lot of mystical feelings about certain magic characters.  You
will have to do a lot of escaping to typeset curly braces and percent
signs, for example, like this:
``The {\tt \%module} directive
sets the name of the initialization function.  This is optional, but is
recommended if building a Tcl 7.5 module.
Everything inside the {\tt \%\{, \%\}}
block is copied directly into the output. allowing the inclusion of
header files and additional C code." \\

Sometimes you want to really call attention to a piece of text.  You
can center it in the column like this:
\begin{center}
{\tt \_1008e614\_Vector\_p}
\end{center}
and people will really notice it.\\

\noindent
The noindent at the start of this paragraph makes it clear that it's
a continuation of the preceding text, not a new para in its own right.


Now this is an ingenious way to get a forced space.
{\tt Real~$*$} and {\tt double~$*$} are equivalent. 

Now here is another way to call attention to a line of code, but instead
of centering it, we noindent and bold it.\\

\noindent
{\bf \tt size\_t : fread ptr size nobj stream } \\

And here we have made an indented para like a definition tag (dt)
in HTML.  You don't need a surrounding list macro pair.
\begin{itemize}
\item[]  {\tt fread} reads from {\tt stream} into the array {\tt ptr} at
most {\tt nobj} objects of size {\tt size}.   {\tt fread} returns
the number of objects read. 
\end{itemize}
This concludes the definitions tag.

\subsection{Model Selection}
In the simhash based cloaking detection model, input from the user is simply simhash. How to compare against the simhashs that is already collected?

One simple way is to compute the average distance from this simhash to all the observed simhashs. The next step is then to tell whether this distance is reasonable. 

The text distribution follows lognormal distribution.
After mannual check of those results.




You have to run {\tt latex} once to prepare your references for
munging.  Then run {\tt bibtex} to build your bibliography metadata.
Then run {\tt latex} twice to ensure all references have been resolved.
If your source file is called {\tt usenixTemplate.tex} and your {\tt
  bibtex} file is called {\tt usenixTemplate.bib}, here's what you do:
{\tt \small
\begin{verbatim}
latex usenixTemplate
bibtex usenixTemplate
latex usenixTemplate
latex usenixTemplate
\end{verbatim}
}


\subsection{Last SubSection}

Well, it's getting boring isn't it.  This is the last subsection
before we wrap it up.

\section{Acknowledgments}

A polite author always includes acknowledgments.  Thank everyone,
especially those who funded the work. 

\section{Availability}

It's great when this section says that MyWonderfulApp is free software, 
available via anonymous FTP from

\begin{center}
{\tt ftp.site.dom/pub/myname/Wonderful}\\
\end{center}

Also, it's even greater when you can write that information is also 
available on the Wonderful homepage at 

\begin{center}
{\tt http://www.site.dom/\~{}myname/SWIG}
\end{center}

Now we get serious and fill in those references.  Remember you will
have to run latex twice on the document in order to resolve those
cite tags you met earlier.  This is where they get resolved.
We've preserved some real ones in addition to the template-speak.
After the bibliography you are DONE.

{\footnotesize \bibliographystyle{acm}
%\bibliography{../common/bibliography}}
\bibliography{ruian}}

\theendnotes

\end{document}







